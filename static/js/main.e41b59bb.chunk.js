(this.webpackJsonpparoleheritage=this.webpackJsonpparoleheritage||[]).push([[0],{106:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),o=t(27),l=(t(86),t(87),t(15)),i=t(31);var c=t(23),s=t(13),u=t(9),m=t(59),d=t.n(m),p=t(7),E=(t(89),t(91),t(93),t(107),t(69)),b=t(43);Object(p.initializeApp)({apiKey:"AIzaSyC7NOgNI4R8tlbLU6KW3hmoDSh_q2nZz40",authDomain:"parole-cce00.firebaseapp.com",databaseURL:"https://parole-cce00.firebaseio.com",projectId:"parole-cce00",storageBucket:"parole-cce00.appspot.com",messagingSenderId:"129631543892",appId:"1:129631543892:web:04f736403b7ce0f5ce83c1",measurementId:"G-4592WN0SEC"});var f=r.a.createContext({storage:p.storage,auth:p.auth,database:p.database,firestore:p.firestore,useDocument:b.b,useCollection:b.a,user:Object(p.auth)().currentUser,addParole:function(e){return new Promise},editParole:function(e){return new Promise},doSignUpWithEmailAndPasswd:function(e){return new Promise},doSignInWithEmailAndPasswd:function(e){return new Promise},doSignInWithFacebook:function(){},doSignInWithGoogle:function(){}});function h(e){var a=e.children,t=Object(E.a)(Object(p.auth)()),n=Object(u.a)(t,1)[0],o={storage:p.storage,auth:p.auth,database:p.database,firestore:p.firestore,useDocument:b.b,useCollection:b.a,user:n,addParole:function(e){return new Promise((function(a,t){Object(p.firestore)().collection("chansons").add(Object(s.a)({},e)).then((function(e){Object(p.firestore)().collection(n?"utilisateurs/".concat(n.uid,"/chansons"):"utilisateurs/anonymous/chansons").add({reference:e}),a(e)})).catch((function(e){t(e)}))}))},editParole:function(e){return new Promise((function(a,t){var r=Object(p.firestore)().doc("paroles/".concat(e.id)),o=n?n.displayName:"anonymous";Object(p.firestore)().runTransaction((function(a){var t,n,l;return d.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,d.a.awrap(a.get(r));case 2:t=i.sent,n=String(t.data().paroles),l=String(t.data().ajout_par),a.update(r,{paroles:e.edit,editBy:o,date_edit:e.date_edit}),Object(p.firestore)().collection("notifications/".concat(l,"/chansons")).add({paroles:[n,e.edit],reference:r,editee_par:o});case 7:case"end":return i.stop()}}))}))}))},doSignUpWithEmailAndPasswd:function(e){return new Promise((function(a,t){Object(p.firestore)().collection("utilisateurs").where("utilsateur","==",e.utilsateur).get().then((function(n){0===n.size?Object(p.auth)().createUserWithEmailAndPassword(e.email,e.passwd).then((function(a){return Object(p.firestore)().collection("utilisateurs").doc(a.user.uid).set(Object(s.a)({},e,{passwd:""}))})).then((function(){return Object(p.auth)().currentUser.sendEmailVerification({url:"https://tlenoir.github.com/paroleheritage/"})})).then((function(){Object(p.auth)().currentUser.updateProfile({displayName:e.utilsateur}),a(Object(p.auth)().currentUser)})).catch((function(e){t(e)})):t({message:"Ce nom d'utilisateur est d\xe9j\xe0 utilis\xe9!"})}))}))},doSignInWithEmailAndPasswd:function(e){return new Promise((function(a,t){Object(p.auth)().signInWithEmailAndPassword(e.email,e.passwd).then((function(e){a(e)})).catch((function(e){t(e)}))}))},doSignInWithFacebook:function(){return Object(p.auth)().signInWithPopup(new p.auth.FacebookAuthProvider).then((function(e){Object(p.firestore)().collection("utilisateurs").doc(e.user.uid).set({utilisateur:e.user.displayName,email:e.user.email,date_creation:e.user.metadata.creationTime})}))},doSignInWithGoogle:function(){return Object(p.auth)().signInWithPopup(new p.auth.GoogleAuthProvider).then((function(e){Object(p.firestore)().collection("utilisateurs").doc(e.user.uid).set({utilisateur:e.user.displayName,email:e.user.email,date_creation:e.user.metadata.creationTime})}))}};return r.a.createElement(f.Provider,{value:o},a)}var g=t(109),v=t(110),O=t(118),j=t(73),C=t(113),y=t(115),w=t(75),k=t(111),I=t(34),P=t(53),S=t(38),x=t.n(S);t(65);function G(){var e=Object(n.useContext)(f),a=e.user,t=Object(n.useState)(!1),o=Object(u.a)(t,2),i=o[0],m=o[1],d=Object(n.useState)(!1),p=Object(u.a)(d,2),E=p[0],b=p[1],h=Object(n.useState)(!1),g=Object(u.a)(h,2),v=g[0],O=g[1],S=Object(n.useState)({paroles:"",artistes:"",titre:"",groupes:""}),G=Object(u.a)(S,2),q=G[0],L=G[1],N=function(){return O(!1)},A=function(e){return L(Object(s.a)({},q,Object(c.a)({},e.target.name,e.target.value)))};return Object(n.useEffect)((function(){E&&e.addParole(q).then((function(){O(!1),L({paroles:"",artistes:"",titre:"",groupes:""})})).then((function(){b(!1)}))}),[E]),r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{onClick:function(){return O(!0)},variant:"link"},r.a.createElement(I.a,{className:"mr-1",icon:P.a}),"Ajouter une chanson"),r.a.createElement(C.a,{size:"lg",show:v,onHide:N},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,"Ajouter une Chanson")),r.a.createElement(y.a,{noValidate:!0,validated:i,onSubmit:function(e){e.currentTarget.checkValidity()&&(L(Object(s.a)({},q,{date_ajout:x()().local("fr").format("LLL"),ajout_par:a?a.displayName:"anonymous",artistes:q.artistes.length>0?q.artistes.split(";"):"",groupes:q.groupes.length>0?q.groupes.split(";"):""})),b(!0)),m(!0),e.preventDefault()}},r.a.createElement(C.a.Body,null,r.a.createElement(y.a.Row,null,r.a.createElement(y.a.Group,{as:w.a,md:"6",controlId:"formGridTiltle"},r.a.createElement(y.a.Label,null,"Titre"),r.a.createElement(y.a.Control,{readOnly:E,required:!0,value:q.titre,name:"titre",onChange:A,type:"text"})),r.a.createElement(y.a.Group,{as:w.a,md:"6",controlId:"formGridArtiste"},r.a.createElement(y.a.Label,null,"Artiste"),r.a.createElement(y.a.Control,{readOnly:E,value:q.artistes,name:"artistes",onChange:A,type:"text",placeholder:"art1;art2"}))),r.a.createElement(y.a.Group,{controlId:"formGridGroup"},r.a.createElement(y.a.Label,null,"Groupe"),r.a.createElement(y.a.Control,{readOnly:E,value:q.groupes,name:"groupes",onChange:A,type:"text",placeholder:"grp1;grp2"})),r.a.createElement(y.a.Group,{controlId:"exampleForm.Control readOnly={submit}Parole"},r.a.createElement(y.a.Label,null,"Parole"),r.a.createElement(y.a.Control,{readOnly:E,value:q.paroles,name:"paroles",onChange:A,as:"textarea",rows:"6"}))),r.a.createElement(C.a.Footer,null,r.a.createElement(k.a,null,r.a.createElement(j.a,{disabled:E,size:"sm",as:l.Link,to:"/",variant:"link",onClick:N},"cr\xe9ation/avanc\xe9e"),r.a.createElement(j.a,{disabled:E,variant:"outline-secondary",onClick:N},"Fermer"),r.a.createElement(j.a,{disabled:E,variant:"primary",type:"submit"},"Enregistrer"))))))}var q=t(112),L=t(76);function N(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Conditions d'utilisation"),r.a.createElement("p",null,"Lorem ipsum dolor sit amet consectetur adipisicing elit. Porro veniam quis dolorem ipsa sapiente ex, hic obcaecati ducimus culpa. Doloribus itaque ducimus temporibus impedit tempora, totam, qui aspernatur nihil rem atque assumenda officiis officia ad sunt deserunt doloremque optio in quibusdam quaerat? Optio minus fugit id consequuntur blanditiis voluptates necessitatibus. Praesentium totam ut eos sint pariatur fugiat nulla nam perspiciatis velit! Illo explicabo aut, veniam veritatis quia sit accusamus. Fugit, dicta earum quibusdam ex quia quod esse aut distinctio saepe dolor sunt itaque facere ut quasi alias velit odio repellendus molestiae voluptatem suscipit. Atque in, repellendus dolore ea beatae impedit rem eum hic sit aspernatur saepe laboriosam facilis suscipit odio, dolores similique provident, molestiae neque enim doloremque recusandae cumque id."))}var A=[{path:"/",component:function(){return r.a.createElement("div",null,"Accueil page.")},exact:!0,name:"Accueil"},{path:"/apropos",component:function(){return r.a.createElement("div",null,"\xc0 propos page.")},exact:!0,name:"\xc0 propos"},{path:"/liste",component:function(){var e=Object(n.useContext)(f),a=e.useCollection(e.firestore().collection("chansons"),{snapshotListenOptions:{includeMetadataChanges:!0}}),t=Object(u.a)(a,3),o=t[0],i=t[1],c=t[2];return r.a.createElement(r.a.Fragment,null,c&&r.a.createElement(g.a,{variant:"danger"},"Erreur: ",c.message),i&&r.a.createElement(v.a,{animation:"grow",variant:"primary"}),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(G,null),r.a.createElement(O.a,{variant:"flush"},o.docs.map((function(e){return r.a.createElement(O.a.Item,{variant:"light",as:l.Link,to:"/liste=".concat(e.id),key:e.id},e.data().titre)})))))},exact:!0,name:"Liste"}],F=[{path:"/liste=:id",component:function(){var e=Object(n.useContext)(f),a=Object(i.m)().id,t=Object(n.useState)(!0),o=Object(u.a)(t,2),l=o[0],m=o[1],d=Object(n.useState)({paroles:"",titre:""}),p=Object(u.a)(d,2),E=p[0],b=p[1],h=e.useDocument(e.firestore().doc("chansons/".concat(a)),{snapshotListenOptions:{includeMetadataChanges:!0}}),O=Object(u.a)(h,3),C=O[0],w=O[1],k=O[2],I=function(e){b(Object(s.a)({},E,Object(c.a)({},e.target.name,e.target.value)))};return Object(n.useEffect)((function(){C&&b({titre:C.data().titre,paroles:C.data().paroles})}),[C]),r.a.createElement(r.a.Fragment,null,k&&r.a.createElement(g.a,{variant:"danger"},"Erreur: ",k.message),w&&r.a.createElement(v.a,{animation:"grow",variant:"primary"}),C&&r.a.createElement(q.a,null,r.a.createElement(j.a,{variant:"link",size:"sm",onClick:function(e){m(!1),e.preventDefault()}},"edit\xe9"),r.a.createElement(y.a,null,r.a.createElement(y.a.Group,{controlId:"exampleForm.ControlInputTitre"},r.a.createElement(y.a.Label,{srOnly:l},"Titre"),r.a.createElement(y.a.Control,{size:"lg",value:E.titre,name:"titre",plaintext:l,required:!0,onChange:I,readOnly:l,type:"text"})),r.a.createElement(y.a.Group,{controlId:"exampleForm.ControlTextareaParole"},r.a.createElement(y.a.Label,{srOnly:l},"Parole"),r.a.createElement(y.a.Control,{value:E.paroles,name:"paroles",plaintext:l,required:!0,onChange:I,readOnly:l,as:L.a})))))},exact:!0},{path:"/signup",component:function(){var e=Object(n.useContext)(f),a=Object(i.k)(),t=Object(n.useState)(!1),o=Object(u.a)(t,2),l=o[0],m=o[1],d=Object(n.useState)(!1),p=Object(u.a)(d,2),E=p[0],b=p[1],h=Object(n.useState)(""),O=Object(u.a)(h,2),k=O[0],I=O[1],P=Object(n.useState)(!1),S=Object(u.a)(P,2),G=S[0],q=S[1],L=Object(n.useState)({email:"",passwd:"",nom:"",prenom:"",utilsateur:"",ville:"",apropos:"",date_naissance:""}),A=Object(u.a)(L,2),F=A[0],W=A[1],D=function(){return q(!1)},T=function(e){W(Object(s.a)({},F,Object(c.a)({},e.target.name,e.target.value)))};return Object(n.useEffect)((function(){E&&e.doSignUpWithEmailAndPasswd(F).then((function(){W({email:"",passwd:"",nom:"",prenom:"",utilsateur:"",ville:"",apropos:"",date_naissance:""}),m(!1)})).then((function(){a.push("/")})).catch((function(e){I(e.message),b(!1)}))}),[E]),r.a.createElement(y.a,{className:"mb-4",noValidate:!0,validated:l,onSubmit:function(a){a.currentTarget.checkValidity()&&(W(Object(s.a)({},F,{date_creation:e.firestore.Timestamp.fromDate(new Date),date_naissance:x()(F.date_naissance).local("fr").format("LL")})),b(!0)),m(!0),a.preventDefault()}},r.a.createElement(y.a.Row,null,r.a.createElement(y.a.Group,{as:w.a,md:"6",controlId:"formGridEmail"},r.a.createElement(y.a.Label,null,"Email"),r.a.createElement(y.a.Control,{required:!0,name:"email",value:F.email,onChange:T,type:"email",placeholder:"parole@tahitienne.com"})),r.a.createElement(y.a.Group,{as:w.a,md:"6",controlId:"formGridMotdepasse"},r.a.createElement(y.a.Label,null,"Mot de passe"),r.a.createElement(y.a.Control,{required:!0,name:"passwd",value:F.passwd,onChange:T,type:"password"}))),r.a.createElement(y.a.Row,null,r.a.createElement(y.a.Group,{as:w.a,md:"4",controlId:"formGridNom"},r.a.createElement(y.a.Label,null,"Nom"),r.a.createElement(y.a.Control,{required:!0,name:"nom",value:F.nom,onChange:T,type:"text",placeholder:"Parole"})),r.a.createElement(y.a.Group,{as:w.a,md:"4",controlId:"formGridPrenom"},r.a.createElement(y.a.Label,null,"Pr\xe9nom"),r.a.createElement(y.a.Control,{required:!0,name:"prenom",value:F.prenom,onChange:T,type:"text",placeholder:"Tahitienne"})),r.a.createElement(y.a.Group,{as:w.a,md:"4",controlId:"formGridNaissance"},r.a.createElement(y.a.Label,null,"Date de naisssance"),r.a.createElement(y.a.Control,{required:!0,name:"date_naissance",value:F.date_naissance,onChange:T,type:"date"}))),r.a.createElement("hr",null),r.a.createElement(y.a.Row,null,r.a.createElement(y.a.Group,{as:w.a,md:"6",controlId:"formGridUtilisateur"},r.a.createElement(y.a.Label,null,"Nom utilisateur"),r.a.createElement(y.a.Control,{required:!0,name:"utilsateur",type:"text",value:F.utilsateur,onChange:T})),r.a.createElement(y.a.Group,{as:w.a,md:"6",controlId:"formGridville"},r.a.createElement(y.a.Label,null,"Ville"),r.a.createElement(y.a.Control,{required:!0,name:"ville",value:F.ville,onChange:T,type:"text",placeholder:"Paea"}))),r.a.createElement("hr",null),r.a.createElement(y.a.Row,null),r.a.createElement(y.a.Group,{as:w.a,controlId:"formGridApropos"},r.a.createElement(y.a.Label,null,"\xc0 propos"),r.a.createElement(y.a.Control,{name:"apropos",as:"textarea",value:F.apropos,onChange:T})),r.a.createElement(y.a.Group,{id:"formGridCheckbox"},r.a.createElement(j.a,{variant:"link",onClick:function(){return q(!0)},size:"sm"},"conditions d'utilisation"),r.a.createElement(y.a.Check,{required:!0,className:"text-left",type:"checkbox",label:"J'accepte"})),r.a.createElement(j.a,{variant:E?"link":"primary",type:"submit",disabled:E},E?r.a.createElement(v.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}):"Inscription"),k&&r.a.createElement(g.a,{className:"mt-2",variant:"danger"},k),r.a.createElement(C.a,{scrollable:!0,show:G,onHide:D},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,"Parole H\xe9ritage")),r.a.createElement(C.a.Body,null,r.a.createElement(N,null)),r.a.createElement(C.a.Footer,null,r.a.createElement(j.a,{variant:"secondary",onClick:D},"Close"))))},exact:!0}],W=t(116),D=t(117),T=t(77),_=t(114),B=t(63);function z(){var e=Object(n.useContext)(f),a=Object(n.useState)(!1),t=Object(u.a)(a,2),o=t[0],i=t[1],m=Object(n.useState)(!1),d=Object(u.a)(m,2),p=d[0],E=d[1],b=Object(n.useState)(""),h=Object(u.a)(b,2),v=h[0],O=h[1],w=Object(n.useState)(!1),k=Object(u.a)(w,2),P=k[0],S=k[1],x=Object(n.useState)({email:"",passwd:""}),G=Object(u.a)(x,2),q=G[0],L=G[1],N=function(e){L(Object(s.a)({},q,Object(c.a)({},e.target.name,e.target.value)))},A=function(){i(!1),O("")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{variant:"dark",onClick:function(){return i(!0)}},"S'identifier"),r.a.createElement(C.a,{show:o,onHide:A},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,"Connectez-vous via",r.a.createElement(I.a,{className:"ml-2",onClick:function(){e.doSignInWithFacebook()},icon:B.a,color:"#3b5998"}),r.a.createElement(I.a,{className:"ml-2",onClick:function(){e.doSignInWithGoogle()},icon:B.b,color:"#DD4B39"}))),r.a.createElement(y.a,{noValidate:!0,validated:p,onSubmit:function(a){a.currentTarget.checkValidity()&&(S(!0),e.doSignInWithEmailAndPasswd(q).then((function(){i(!1),L({email:"",passwd:""})})).catch((function(e){O(e.message),S(!1)}))),E(!0),a.preventDefault()}},r.a.createElement(C.a.Body,null,r.a.createElement(y.a.Group,{controlId:"formBasicEmail"},r.a.createElement(y.a.Label,null,"Email/Identifiant"),r.a.createElement(y.a.Control,{required:!0,type:"email",readOnly:P,value:q.email,name:"email",onChange:N})),r.a.createElement(y.a.Group,{controlId:"formBasicPassword"},r.a.createElement(y.a.Label,null,"Password"),r.a.createElement(y.a.Control,{required:!0,type:"password",readOnly:P,value:q.passwd,name:"passwd",onChange:N}))),r.a.createElement(C.a.Footer,null,r.a.createElement(j.a,{as:l.Link,to:"/signup",variant:"link",onClick:A,disabled:P},"cr\xe9er un compte"),r.a.createElement(j.a,{variant:"secondary",onClick:A,disabled:P},"Fermer"),r.a.createElement(j.a,{variant:"primary",type:"submit",disabled:P},"S'identifier"),v&&r.a.createElement(g.a,{variant:"danger"},v)))))}function U(){var e=Object(n.useContext)(f),a=e.user;return r.a.createElement(_.a,null,r.a.createElement(_.a.Toggle,{variant:"info",id:"dropdown-basic"},r.a.createElement(I.a,{className:"mr-1",icon:P.b}),a.displayName),r.a.createElement(_.a.Menu,{className:"dropdown-menu-md-right"},r.a.createElement(_.a.Item,{as:l.Link,to:"/profile"},"Profile"),r.a.createElement(_.a.Divider,null),r.a.createElement(_.a.Item,{onClick:function(){e.auth().signOut()}},"D\xe9connecter")))}function H(){var e=Object(n.useContext)(f).user;return r.a.createElement(r.a.Fragment,null,e&&r.a.createElement(U,null),!e&&r.a.createElement(z,null))}function V(){return r.a.createElement(W.a,{className:"mb-2",collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},r.a.createElement(W.a.Brand,{href:"/"},"Parole H\xe9ritage"),r.a.createElement(W.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(W.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(D.a,{className:"mr-auto"},A.map((function(e){return r.a.createElement(T.LinkContainer,{key:e.path,to:e.path},r.a.createElement(D.a.Link,null,e.name))}))),r.a.createElement(H,null)))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(o.render)(r.a.createElement((function(){return Object(n.useDebugValue)("123456789"),r.a.createElement(l.HashRouter,{basename:"/paroleheritage"},r.a.createElement(h,null,r.a.createElement(V,null),r.a.createElement("div",{className:"container"},r.a.createElement(i.g,null,A.map((function(e){return r.a.createElement(i.d,Object.assign({key:e.path},e))})),F.map((function(e){return r.a.createElement(i.d,Object.assign({key:e.path},e))}))))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},81:function(e,a,t){e.exports=t(106)},86:function(e,a,t){}},[[81,1,2]]]);
//# sourceMappingURL=main.e41b59bb.chunk.js.map